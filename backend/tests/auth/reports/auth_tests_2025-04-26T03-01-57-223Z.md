# Test Report - auth_tests

## Environment
- Node Version: v23.11.0
- Platform: darwin
- API URL: http://localhost:3000
- Timestamp: 2025-04-26T03-01-57-222Z

## Summary
- Total Tests: 8
- Passed: 6
- Failed: 2
- Success Rate: 75.00%

## Endpoints Tested

### auth/register
- Methods: POST
- Total Tests: 4
- Passed: 3
- Failed: 1


### auth/login
- Methods: POST
- Total Tests: 2
- Passed: 1
- Failed: 1


### auth/reset-password
- Methods: POST
- Total Tests: 1
- Passed: 1
- Failed: 0


### auth/logout
- Methods: GET
- Total Tests: 1
- Passed: 1
- Failed: 0


## Detailed Analysis

### User Registration Tests

#### Register with valid data
- Status: 201
- Analysis: ❌ Unexpected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636511840@example.com",
    "password": "Test123456!",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1191",
    "etag": "W/\"4a7-sTdUXFQfqIRdytRwhUTo0MXMF68\"",
    "date": "Sat, 26 Apr 2025 03:01:54 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 201,
  "data": {
    "message": "Usuario registrado correctamente",
    "user": {
      "id": "kZXlNK9rGKfj6NFt0ZtKQJOM8j23",
      "email": "test1745636511840@example.com",
      "name": "Test User",
      "role": "user",
      "createdAt": {},
      "updatedAt": {}
    },
    "tokens": {
      "idToken": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkwOTg1NzhjNDg4MWRjMDVlYmYxOWExNWJhMjJkOGZkMWFiMzRjOGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vcGV0LWFwaS1kZXYtMzUxMTUiLCJhdWQiOiJwZXQtYXBpLWRldi0zNTExNSIsImF1dGhfdGltZSI6MTc0NTYzNjUxMiwidXNlcl9pZCI6ImtaWGxOSzlyR0tmajZORnQwWnRLUUpPTThqMjMiLCJzdWIiOiJrWlhsTks5ckdLZmo2TkZ0MFp0S1FKT004ajIzIiwiaWF0IjoxNzQ1NjM2NTEyLCJleHAiOjE3NDU2NDAxMTIsImVtYWlsIjoidGVzdDE3NDU2MzY1MTE4NDBAZXhhbXBsZS5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsidGVzdDE3NDU2MzY1MTE4NDBAZXhhbXBsZS5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.eTQyRx5CkDvtL0GG8yJlumvbXRXoNVwVjM3E3ddx0TGkw5JPMyYXyG63HngFWtTKD8Y5D3TctC5GWXub_9VEohk9ViupgAW4BIT7RcMmne_83DidVjD7KAtLABAW49PKNZ1c10moOoq-qWaOuAvLnhxbwYx5kQMhmd5_3AKlY9EqMS3ELErzoctsGtYFSsll40H5KHZJReUf1dAxhNJAmnj3gnoSHJd3C0xwBCkIaEJtl1RN-qaJ9w__8zh6AjUINUjV_9n10iQaEIBrDsCy-WymR8QuPL2CX_iJ6MALHUTaIjMMstcigiKzgYdMUuoQ0zdypFT6g4jbOaUWaQ6G2w",
      "expiresIn": 3600
    }
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1191",
    "etag": "W/\"4a7-sTdUXFQfqIRdytRwhUTo0MXMF68\"",
    "date": "Sat, 26 Apr 2025 03:01:54 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with invalid email
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "invalid-email",
    "password": "Test123456!",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "38",
    "etag": "W/\"26-a2KtX56nN9d92pNRP+9lzUo4Qkc\"",
    "date": "Sat, 26 Apr 2025 03:01:54 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Formato de email inválido"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "38",
    "etag": "W/\"26-a2KtX56nN9d92pNRP+9lzUo4Qkc\"",
    "date": "Sat, 26 Apr 2025 03:01:54 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with weak password
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636514987@example.com",
    "password": "123",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-bm1FhnjpnP+uQHC7fKC+FJKgbOw\"",
    "date": "Sat, 26 Apr 2025 03:01:54 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "La contraseña debe tener al menos 6 caracteres"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-bm1FhnjpnP+uQHC7fKC+FJKgbOw\"",
    "date": "Sat, 26 Apr 2025 03:01:54 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with missing fields
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636515006@example.com"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "65",
    "etag": "W/\"41-cBg7B6HGrqcvr6qG/tjfU7cjOAE\"",
    "date": "Sat, 26 Apr 2025 03:01:55 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Se requieren todos los campos: email, password y name"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "65",
    "etag": "W/\"41-cBg7B6HGrqcvr6qG/tjfU7cjOAE\"",
    "date": "Sat, 26 Apr 2025 03:01:55 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### User Login Tests

#### Login with valid credentials
- Status: 200
- Analysis: ❌ Unexpected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/login",
  "data": {
    "email": "test1745636511840@example.com",
    "password": "Test123456!"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1521",
    "etag": "W/\"5f1-UJqwFPEl00IhIII9KD3Z3LbhrCI\"",
    "date": "Sat, 26 Apr 2025 03:01:55 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "user": {
      "id": "kZXlNK9rGKfj6NFt0ZtKQJOM8j23",
      "email": "test1745636511840@example.com",
      "name": "Test User",
      "role": "user",
      "createdAt": {
        "_seconds": 1745636514,
        "_nanoseconds": 71000000
      },
      "updatedAt": {
        "_seconds": 1745636514,
        "_nanoseconds": 71000000
      }
    },
    "tokens": {
      "idToken": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkwOTg1NzhjNDg4MWRjMDVlYmYxOWExNWJhMjJkOGZkMWFiMzRjOGEiLCJ0eXAiOiJKV1QifQ.eyJyb2xlIjoidXNlciIsImlzcyI6Imh0dHBzOi8vc2VjdXJldG9rZW4uZ29vZ2xlLmNvbS9wZXQtYXBpLWRldi0zNTExNSIsImF1ZCI6InBldC1hcGktZGV2LTM1MTE1IiwiYXV0aF90aW1lIjoxNzQ1NjM2NTE1LCJ1c2VyX2lkIjoia1pYbE5LOXJHS2ZqNk5GdDBadEtRSk9NOGoyMyIsInN1YiI6ImtaWGxOSzlyR0tmajZORnQwWnRLUUpPTThqMjMiLCJpYXQiOjE3NDU2MzY1MTUsImV4cCI6MTc0NTY0MDExNSwiZW1haWwiOiJ0ZXN0MTc0NTYzNjUxMTg0MEBleGFtcGxlLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJlbWFpbCI6WyJ0ZXN0MTc0NTYzNjUxMTg0MEBleGFtcGxlLmNvbSJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.RAdgUycPewcA5N7-tiCuZrr7T94uBTaMFEiB0DCOnEg7fGUNeR5AtFtbbWpDaqGwpKBMwffVcd-q2RPIHucANSlb5nEC6InoK1CjlchJtNQArK6N3izPt4CZ4OQKTzt5DkVWmcVEGSBo8Hoe6jDYFHAwG0LQIEPo_UGzHLNTT3O-SgoVvGXi33pIW88cQlOiBCgV0KHbm9CC2RDfrHTuI2-uhD4IpKlLJgP1vTPerujJySCuOC0rWT6cJkUlUoa4bKuaKROb0MRtaBYStvkVj5X6KFUd29FW_oJuFIvHNEs4vygBpq1gBpCzF2j-1Xj_d104csXepWupcRTFPXsOTg",
      "refreshToken": "AMf-vBxzpmjzUtB-vNdFiKxjdM-RRxJxOR6tDOis6vSMcUiKgr7h4_oK-2JWymwR8RQ7lnYejAOUYKIRm4rrewGJ6ZpcFZdl9fqn6Kqg8pDlaVGwa5xdpGhG5XeSW6bBjni_OVTPl9uREL3yehC6TYbRjz0_UT83TjHMY2kPh5yia29E1LqBcPJU3imxXHNIr2JWm5se2PewED0yUAuzLPLwFIyEfEUggpdgzyrW4WqUREFQltf-ndQ",
      "expiresIn": "3600"
    }
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1521",
    "etag": "W/\"5f1-UJqwFPEl00IhIII9KD3Z3LbhrCI\"",
    "date": "Sat, 26 Apr 2025 03:01:55 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Login with invalid password
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/login",
  "data": {
    "email": "test1745636511840@example.com",
    "password": "wrongpassword"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "73",
    "etag": "W/\"49-jL22qI9XzW7ZXzyHTnJcavz1C9o\"",
    "date": "Sat, 26 Apr 2025 03:01:55 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Error de autenticación",
    "details": "INVALID_LOGIN_CREDENTIALS"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "73",
    "etag": "W/\"49-jL22qI9XzW7ZXzyHTnJcavz1C9o\"",
    "date": "Sat, 26 Apr 2025 03:01:55 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### Password Reset Tests

#### Request password reset with valid email
- Status: 200
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/reset-password",
  "data": {
    "email": "test1745636511840@example.com"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-7+XrS/J3yfz/aqsO15MxUS0GD0g\"",
    "date": "Sat, 26 Apr 2025 03:01:56 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "message": "Correo de recuperación enviado correctamente"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-7+XrS/J3yfz/aqsO15MxUS0GD0g\"",
    "date": "Sat, 26 Apr 2025 03:01:56 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### Logout Tests

#### Logout with valid token
- Status: 200
- Analysis: ❌ Unexpected behavior
- Request:
```json
{
  "method": "GET",
  "endpoint": "auth/logout",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "43",
    "etag": "W/\"2b-MyejiszC7Gtv4lyEuC93gc43Iqk\"",
    "date": "Sat, 26 Apr 2025 03:01:57 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "message": "Sesión cerrada correctamente"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "43",
    "etag": "W/\"2b-MyejiszC7Gtv4lyEuC93gc43Iqk\"",
    "date": "Sat, 26 Apr 2025 03:01:57 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


## Recommendations
- **CRITICAL**: Overall test success rate is below 80%. Immediate attention required.
- **WARNING**: User Registration test suite has 3 failing tests.
- **WARNING**: User Login test suite has 1 failing tests.
