# Test Report - auth_tests

## Environment
- Node Version: v23.11.0
- Platform: darwin
- API URL: http://localhost:3000
- Timestamp: 2025-04-26T03-00-06-113Z

## Summary
- Total Tests: 8
- Passed: 6
- Failed: 2
- Success Rate: 75.00%

## Endpoints Tested

### auth/register
- Methods: POST
- Total Tests: 4
- Passed: 3
- Failed: 1


### auth/login
- Methods: POST
- Total Tests: 2
- Passed: 1
- Failed: 1


### auth/reset-password
- Methods: POST
- Total Tests: 1
- Passed: 1
- Failed: 0


### auth/logout
- Methods: GET
- Total Tests: 1
- Passed: 1
- Failed: 0


## Detailed Analysis

### User Registration Tests

#### Register with valid data
- Status: 201
- Analysis: ❌ Unexpected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636400991@example.com",
    "password": "Test123456!",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1191",
    "etag": "W/\"4a7-THjCpsI77M9jK0Nc1O0NLIFNQbg\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 201,
  "data": {
    "message": "Usuario registrado correctamente",
    "user": {
      "id": "Pztc24hv1oQv3IW2MtnD3n9dfsF3",
      "email": "test1745636400991@example.com",
      "name": "Test User",
      "role": "user",
      "createdAt": {},
      "updatedAt": {}
    },
    "tokens": {
      "idToken": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkwOTg1NzhjNDg4MWRjMDVlYmYxOWExNWJhMjJkOGZkMWFiMzRjOGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vcGV0LWFwaS1kZXYtMzUxMTUiLCJhdWQiOiJwZXQtYXBpLWRldi0zNTExNSIsImF1dGhfdGltZSI6MTc0NTYzNjQwMiwidXNlcl9pZCI6IlB6dGMyNGh2MW9RdjNJVzJNdG5EM245ZGZzRjMiLCJzdWIiOiJQenRjMjRodjFvUXYzSVcyTXRuRDNuOWRmc0YzIiwiaWF0IjoxNzQ1NjM2NDAyLCJleHAiOjE3NDU2NDAwMDIsImVtYWlsIjoidGVzdDE3NDU2MzY0MDA5OTFAZXhhbXBsZS5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsidGVzdDE3NDU2MzY0MDA5OTFAZXhhbXBsZS5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.G6klvFsTgwKBjGTl4oyZVDbnwlTcijRVJvheTGxbr1Wu99r_PpAG11HxigDpv9uOijIu9sTE4pEYDV2XNJw8UhYUvB-BtrODlN0vhSJcsXI0tdl3gb4Pvx6xwJ0IA_mqD_moFcuOVDrQ09JDihENeFzSP8uxhbL5cb9eFNXFfReq9AaGsqf2PiyOdYG_JVMgwYF8Ss7ffsiMk9ClRRkuBGpmMLD7WevLSzussl2q30AynuO2DiqUQINBVDTEau61EX_cPLBACpKOYieHUVNCqAjVpATlTioDndkCiaQzIMq1Ve9eBTkMVaDLmSgfXX_gHx02r0mLHgNSHp4UrixBPQ",
      "expiresIn": 3600
    }
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1191",
    "etag": "W/\"4a7-THjCpsI77M9jK0Nc1O0NLIFNQbg\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with invalid email
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "invalid-email",
    "password": "Test123456!",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "38",
    "etag": "W/\"26-a2KtX56nN9d92pNRP+9lzUo4Qkc\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Formato de email inválido"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "38",
    "etag": "W/\"26-a2KtX56nN9d92pNRP+9lzUo4Qkc\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with weak password
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636404208@example.com",
    "password": "123",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-bm1FhnjpnP+uQHC7fKC+FJKgbOw\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "La contraseña debe tener al menos 6 caracteres"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-bm1FhnjpnP+uQHC7fKC+FJKgbOw\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with missing fields
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636404242@example.com"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "65",
    "etag": "W/\"41-cBg7B6HGrqcvr6qG/tjfU7cjOAE\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Se requieren todos los campos: email, password y name"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "65",
    "etag": "W/\"41-cBg7B6HGrqcvr6qG/tjfU7cjOAE\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### User Login Tests

#### Login with valid credentials
- Status: 200
- Analysis: ❌ Unexpected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/login",
  "data": {
    "email": "test1745636400991@example.com",
    "password": "Test123456!"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1523",
    "etag": "W/\"5f3-giY4cBh4psfz8WxEwatzIgBQhyY\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "user": {
      "id": "Pztc24hv1oQv3IW2MtnD3n9dfsF3",
      "email": "test1745636400991@example.com",
      "name": "Test User",
      "role": "user",
      "createdAt": {
        "_seconds": 1745636403,
        "_nanoseconds": 128000000
      },
      "updatedAt": {
        "_seconds": 1745636403,
        "_nanoseconds": 128000000
      }
    },
    "tokens": {
      "idToken": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkwOTg1NzhjNDg4MWRjMDVlYmYxOWExNWJhMjJkOGZkMWFiMzRjOGEiLCJ0eXAiOiJKV1QifQ.eyJyb2xlIjoidXNlciIsImlzcyI6Imh0dHBzOi8vc2VjdXJldG9rZW4uZ29vZ2xlLmNvbS9wZXQtYXBpLWRldi0zNTExNSIsImF1ZCI6InBldC1hcGktZGV2LTM1MTE1IiwiYXV0aF90aW1lIjoxNzQ1NjM2NDA0LCJ1c2VyX2lkIjoiUHp0YzI0aHYxb1F2M0lXMk10bkQzbjlkZnNGMyIsInN1YiI6IlB6dGMyNGh2MW9RdjNJVzJNdG5EM245ZGZzRjMiLCJpYXQiOjE3NDU2MzY0MDQsImV4cCI6MTc0NTY0MDAwNCwiZW1haWwiOiJ0ZXN0MTc0NTYzNjQwMDk5MUBleGFtcGxlLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJlbWFpbCI6WyJ0ZXN0MTc0NTYzNjQwMDk5MUBleGFtcGxlLmNvbSJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.ed-vdTCUbiM94VXnexY09cMUiOCFTsirBmV-Ll5oUpErGnyuN1h7VuN1qqts6w2UIre-C2v11W8MnO22mS5k4jReYvKOK38pJOL522MOUnIIpaHwV1joInW4eOzI2TYOLWUJ8z6CCk8YkQ-jiSDzLh1aHtJdgwLAZ8Je5cn9db-j1J2iVLl9ax1pSjWOFzbGOLJqBKIsNHzcveE8o4uX6pqI17qVRI7Q_8BP1NF0W-Uzdx4i-zPyk4cxqRroa0mmWuGyXivBVbLslSgn1NVq5Eg6NRvR4b2ENqxGZAXgM3gYau8t3McEzuz-reU6pd2_V3oWX1ETKXI7UD_jD8ASWg",
      "refreshToken": "AMf-vBxj4NYMKjJY0oQ3JfQ0CnkCDqQomgv6nSLBC9AXaN13DyE8s6C-ww5odjRc904Y1hyaGDlBVcGASDkK22KrzIq-gODpj7XeOJThcn2HBNIzzskGlezm84T1Xg8kFXWpeUA4UZE1dwXJ3FzS8N3BNxumAOVvYpoFHPg8IuE0FOsrrvqFy0QE5c2DHEMAOzlaNgPhi9CtySrx18yZxrvuhlZa0rBm1eMJ9ieW_5oFKnmO1_cc0WQ",
      "expiresIn": "3600"
    }
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1523",
    "etag": "W/\"5f3-giY4cBh4psfz8WxEwatzIgBQhyY\"",
    "date": "Sat, 26 Apr 2025 03:00:04 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Login with invalid password
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/login",
  "data": {
    "email": "test1745636400991@example.com",
    "password": "wrongpassword"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "73",
    "etag": "W/\"49-jL22qI9XzW7ZXzyHTnJcavz1C9o\"",
    "date": "Sat, 26 Apr 2025 03:00:05 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Error de autenticación",
    "details": "INVALID_LOGIN_CREDENTIALS"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "73",
    "etag": "W/\"49-jL22qI9XzW7ZXzyHTnJcavz1C9o\"",
    "date": "Sat, 26 Apr 2025 03:00:05 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### Password Reset Tests

#### Request password reset with valid email
- Status: 200
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/reset-password",
  "data": {
    "email": "test1745636400991@example.com"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-7+XrS/J3yfz/aqsO15MxUS0GD0g\"",
    "date": "Sat, 26 Apr 2025 03:00:05 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "message": "Correo de recuperación enviado correctamente"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-7+XrS/J3yfz/aqsO15MxUS0GD0g\"",
    "date": "Sat, 26 Apr 2025 03:00:05 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### Logout Tests

#### Logout with valid token
- Status: 200
- Analysis: ❌ Unexpected behavior
- Request:
```json
{
  "method": "GET",
  "endpoint": "auth/logout",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "43",
    "etag": "W/\"2b-MyejiszC7Gtv4lyEuC93gc43Iqk\"",
    "date": "Sat, 26 Apr 2025 03:00:06 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "message": "Sesión cerrada correctamente"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "43",
    "etag": "W/\"2b-MyejiszC7Gtv4lyEuC93gc43Iqk\"",
    "date": "Sat, 26 Apr 2025 03:00:06 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


## Recommendations
- **CRITICAL**: Overall test success rate is below 80%. Immediate attention required.
- **WARNING**: User Registration test suite has 3 failing tests.
- **WARNING**: User Login test suite has 1 failing tests.
