# Test Report - auth_tests

## Environment
- Node Version: v23.11.0
- Platform: darwin
- API URL: http://localhost:3000
- Timestamp: 2025-04-26T03-03-43-617Z

## Summary
- Total Tests: 8
- Passed: 6
- Failed: 2
- Success Rate: 75.00%

## Endpoints Tested

### auth/register
- Methods: POST
- Total Tests: 4
- Passed: 3
- Failed: 1


### auth/login
- Methods: POST
- Total Tests: 2
- Passed: 1
- Failed: 1


### auth/reset-password
- Methods: POST
- Total Tests: 1
- Passed: 1
- Failed: 0


### auth/logout
- Methods: GET
- Total Tests: 1
- Passed: 1
- Failed: 0


## Detailed Analysis

### User Registration Tests

#### Register with valid data
- Status: 201
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636619075@example.com",
    "password": "Test123456!",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1191",
    "etag": "W/\"4a7-E3gnebr7tXA6GM39lpVLoHQku70\"",
    "date": "Sat, 26 Apr 2025 03:03:41 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 201,
  "data": {
    "message": "Usuario registrado correctamente",
    "user": {
      "id": "TQYFi4I9kYgM14WDPmOWpyXZsT43",
      "email": "test1745636619075@example.com",
      "name": "Test User",
      "role": "user",
      "createdAt": {},
      "updatedAt": {}
    },
    "tokens": {
      "idToken": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkwOTg1NzhjNDg4MWRjMDVlYmYxOWExNWJhMjJkOGZkMWFiMzRjOGEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vcGV0LWFwaS1kZXYtMzUxMTUiLCJhdWQiOiJwZXQtYXBpLWRldi0zNTExNSIsImF1dGhfdGltZSI6MTc0NTYzNjYxOSwidXNlcl9pZCI6IlRRWUZpNEk5a1lnTTE0V0RQbU9XcHlYWnNUNDMiLCJzdWIiOiJUUVlGaTRJOWtZZ00xNFdEUG1PV3B5WFpzVDQzIiwiaWF0IjoxNzQ1NjM2NjE5LCJleHAiOjE3NDU2NDAyMTksImVtYWlsIjoidGVzdDE3NDU2MzY2MTkwNzVAZXhhbXBsZS5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsidGVzdDE3NDU2MzY2MTkwNzVAZXhhbXBsZS5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.OHo_0F4aKaFQr0lOdKSDPIHtSLBKrIbsnj0mXbB_hCx0xy8vx9BNu8LnWPTB_-CeqT87-W80-QR-3ENU2R3rdCBGs9l4VCeQBveTV9xgy6cEZE4v28yBEk--RR7K9UTPlV-L_NouIZnyKHXBATTh2eh5ONsAOHtFkYZ8NDA5Szo6XS394SCxUyut8N17g4xnSc4rJbDitmv2Y8FdKQDbIfoe0_BPkN3kX3b78sKalumXnU1-hMpN-KNFdeuD5uW-f9rWM4INReLdH_MwmjDdqIzYdRxngs3HL8y8aYXTkJWood5j_BndIaWpE_pF_yOXLufMUp2--J-RYNAlkdNJuQ",
      "expiresIn": 3600
    }
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1191",
    "etag": "W/\"4a7-E3gnebr7tXA6GM39lpVLoHQku70\"",
    "date": "Sat, 26 Apr 2025 03:03:41 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with invalid email
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "invalid-email",
    "password": "Test123456!",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "38",
    "etag": "W/\"26-a2KtX56nN9d92pNRP+9lzUo4Qkc\"",
    "date": "Sat, 26 Apr 2025 03:03:41 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Formato de email inválido"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "38",
    "etag": "W/\"26-a2KtX56nN9d92pNRP+9lzUo4Qkc\"",
    "date": "Sat, 26 Apr 2025 03:03:41 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with weak password
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636621654@example.com",
    "password": "123",
    "name": "Test User"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-bm1FhnjpnP+uQHC7fKC+FJKgbOw\"",
    "date": "Sat, 26 Apr 2025 03:03:41 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "La contraseña debe tener al menos 6 caracteres"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-bm1FhnjpnP+uQHC7fKC+FJKgbOw\"",
    "date": "Sat, 26 Apr 2025 03:03:41 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Register with missing fields
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/register",
  "data": {
    "email": "test1745636621675@example.com"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "65",
    "etag": "W/\"41-cBg7B6HGrqcvr6qG/tjfU7cjOAE\"",
    "date": "Sat, 26 Apr 2025 03:03:41 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Se requieren todos los campos: email, password y name"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "65",
    "etag": "W/\"41-cBg7B6HGrqcvr6qG/tjfU7cjOAE\"",
    "date": "Sat, 26 Apr 2025 03:03:41 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### User Login Tests

#### Login with valid credentials
- Status: 200
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/login",
  "data": {
    "email": "test1745636619075@example.com",
    "password": "Test123456!"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1523",
    "etag": "W/\"5f3-yybvIlG2m4WOCzaytFLwOYOYHhk\"",
    "date": "Sat, 26 Apr 2025 03:03:42 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "user": {
      "id": "TQYFi4I9kYgM14WDPmOWpyXZsT43",
      "email": "test1745636619075@example.com",
      "name": "Test User",
      "role": "user",
      "createdAt": {
        "_seconds": 1745636620,
        "_nanoseconds": 697000000
      },
      "updatedAt": {
        "_seconds": 1745636620,
        "_nanoseconds": 697000000
      }
    },
    "tokens": {
      "idToken": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjkwOTg1NzhjNDg4MWRjMDVlYmYxOWExNWJhMjJkOGZkMWFiMzRjOGEiLCJ0eXAiOiJKV1QifQ.eyJyb2xlIjoidXNlciIsImlzcyI6Imh0dHBzOi8vc2VjdXJldG9rZW4uZ29vZ2xlLmNvbS9wZXQtYXBpLWRldi0zNTExNSIsImF1ZCI6InBldC1hcGktZGV2LTM1MTE1IiwiYXV0aF90aW1lIjoxNzQ1NjM2NjIxLCJ1c2VyX2lkIjoiVFFZRmk0STlrWWdNMTRXRFBtT1dweVhac1Q0MyIsInN1YiI6IlRRWUZpNEk5a1lnTTE0V0RQbU9XcHlYWnNUNDMiLCJpYXQiOjE3NDU2MzY2MjEsImV4cCI6MTc0NTY0MDIyMSwiZW1haWwiOiJ0ZXN0MTc0NTYzNjYxOTA3NUBleGFtcGxlLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJlbWFpbCI6WyJ0ZXN0MTc0NTYzNjYxOTA3NUBleGFtcGxlLmNvbSJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.WJ4pPAISIt2xHSA-nbgE5PSLztAPVYvv2X2sNePp6lzXIiFg1vkvoopEwNJObyFSfd46Ve0Qbo5zQe1u5fp-bqSMDO3KgKpRB9-lI0db3_lPBDamAmmjg9RUSAxs98j6n-A5hCPLC-2CnAWhqsYaV48RK-cOdZGZYKNU9s8fhYhOBYcVP3hfj1YWcIxGm26oQAkube_B0NqAdq_NBUE0QJgj0xJU29HF239x3Ym5ikbVE-Uz0fE_M7omrBx0gfuhMm_52nbcF3n_ScQZG_yQhrcfz4nSVi85Y543iSyZRXPjMn9QTkL-s3DIfk7A1QJac8wpXwr3uYK0AVqlk0y_gA",
      "refreshToken": "AMf-vBwiNZSikG-702dmJ0haBlyou2_H1DxpVSdEotUMJ2pMyQ-oBsTxKbxmKJzmu8HA22n0_KkBZm_06jLrS0pHaZNYQOuMZogpv1359KilEQX4vPZiJOqhEZgsAiXjPBHh7RoIge9M7tGUkUL3h9r3scIZ4Jg14khOxrYxBokwa46vw9uNgmlTHCEgeT1O2LcV4-tQ2HSPbQoAfJA8OHNRJPDv02BA5dviSqq1uGRftDjLIkpkgg4",
      "expiresIn": "3600"
    }
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "1523",
    "etag": "W/\"5f3-yybvIlG2m4WOCzaytFLwOYOYHhk\"",
    "date": "Sat, 26 Apr 2025 03:03:42 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


#### Login with invalid password
- Status: 400
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/login",
  "data": {
    "email": "test1745636619075@example.com",
    "password": "wrongpassword"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "73",
    "etag": "W/\"49-jL22qI9XzW7ZXzyHTnJcavz1C9o\"",
    "date": "Sat, 26 Apr 2025 03:03:42 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 400,
  "data": {
    "error": "Error de autenticación",
    "details": "INVALID_LOGIN_CREDENTIALS"
  },
  "error": "Request failed with status code 400",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "73",
    "etag": "W/\"49-jL22qI9XzW7ZXzyHTnJcavz1C9o\"",
    "date": "Sat, 26 Apr 2025 03:03:42 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### Password Reset Tests

#### Request password reset with valid email
- Status: 200
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "POST",
  "endpoint": "auth/reset-password",
  "data": {
    "email": "test1745636619075@example.com"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-7+XrS/J3yfz/aqsO15MxUS0GD0g\"",
    "date": "Sat, 26 Apr 2025 03:03:42 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "message": "Correo de recuperación enviado correctamente"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "59",
    "etag": "W/\"3b-7+XrS/J3yfz/aqsO15MxUS0GD0g\"",
    "date": "Sat, 26 Apr 2025 03:03:42 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


### Logout Tests

#### Logout with valid token
- Status: 200
- Analysis: ✅ Expected behavior
- Request:
```json
{
  "method": "GET",
  "endpoint": "auth/logout",
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "43",
    "etag": "W/\"2b-MyejiszC7Gtv4lyEuC93gc43Iqk\"",
    "date": "Sat, 26 Apr 2025 03:03:43 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```
- Response:
```json
{
  "status": 200,
  "data": {
    "message": "Sesión cerrada correctamente"
  },
  "headers": {
    "x-powered-by": "Express",
    "vary": "Origin",
    "content-type": "application/json; charset=utf-8",
    "content-length": "43",
    "etag": "W/\"2b-MyejiszC7Gtv4lyEuC93gc43Iqk\"",
    "date": "Sat, 26 Apr 2025 03:03:43 GMT",
    "connection": "keep-alive",
    "keep-alive": "timeout=5"
  }
}
```


## Recommendations
- **CRITICAL**: Overall test success rate is below 80%. Immediate attention required.
- **WARNING**: User Registration test suite has 3 failing tests.
- **WARNING**: User Login test suite has 1 failing tests.
